{"id":"RBR4","dependencies":[{"name":"/Users/erik/webdev/temp/jigsaw-puzzle/package.json","includedInParent":true,"mtime":1607410881326},{"name":"./../utils/sides.js","loc":{"line":1,"column":51},"parent":"/Users/erik/webdev/temp/jigsaw-puzzle/src/lib/make-shapes.js","resolved":"/Users/erik/webdev/temp/jigsaw-puzzle/src/utils/sides.js"},{"name":"./../utils/bezier.js","loc":{"line":2,"column":34},"parent":"/Users/erik/webdev/temp/jigsaw-puzzle/src/lib/make-shapes.js","resolved":"/Users/erik/webdev/temp/jigsaw-puzzle/src/utils/bezier.js"},{"name":"./../utils/random.js","loc":{"line":3,"column":23},"parent":"/Users/erik/webdev/temp/jigsaw-puzzle/src/lib/make-shapes.js","resolved":"/Users/erik/webdev/temp/jigsaw-puzzle/src/utils/random.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.makeShapes=void 0;var e=require(\"./../utils/sides.js\"),s=require(\"./../utils/bezier.js\"),i=require(\"./../utils/random.js\");const r=(r,t)=>{const a=e=>r.find(s=>s.id===e),n=(s,i)=>a(s)&&a(s).shapes&&a(s).shapes[(0,e.opposite)(i)],o={...(({neighbors:r,width:t,height:a})=>Object.keys(r).reduce((o,d)=>({[d]:n(r[d],d)?(0,s.bezierInv)(n(r[d],d)):(0,i.random)()>=.5?(0,s.bezier)((0,e.isVertical)(d)?t:a,Math.min(t,a)):(0,s.bezierInv)((0,s.bezier)((0,e.isVertical)(d)?t:a,Math.min(t,a))),...o}),{}))(t),...(({neighbors:s})=>e.allSides.filter(e=>!Object.keys(s).includes(e)).reduce((e,s)=>({[s]:\"flat\",...e}),{}))(t)};return[{...t,shapes:o},...r]};exports.makeShapes=r;"},"sourceMaps":{"js":{"mappings":[{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":0}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":13}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":20}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":35}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":43}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":56}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":57}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":64}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":68}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":76}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":92}},{"source":"lib/make-shapes.js","original":{"line":1,"column":0},"generated":{"line":1,"column":94}},{"source":"lib/make-shapes.js","original":{"line":1,"column":0},"generated":{"line":1,"column":98}},{"source":"lib/make-shapes.js","original":{"line":1,"column":0},"generated":{"line":1,"column":100}},{"source":"lib/make-shapes.js","original":{"line":1,"column":0},"generated":{"line":1,"column":108}},{"source":"lib/make-shapes.js","original":{"line":2,"column":0},"generated":{"line":1,"column":131}},{"source":"lib/make-shapes.js","original":{"line":2,"column":0},"generated":{"line":1,"column":133}},{"source":"lib/make-shapes.js","original":{"line":2,"column":0},"generated":{"line":1,"column":141}},{"source":"lib/make-shapes.js","original":{"line":3,"column":0},"generated":{"line":1,"column":165}},{"source":"lib/make-shapes.js","original":{"line":3,"column":0},"generated":{"line":1,"column":167}},{"source":"lib/make-shapes.js","original":{"line":3,"column":0},"generated":{"line":1,"column":175}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":199}},{"source":"lib/make-shapes.js","name":"makeShapes","original":{"line":5,"column":13},"generated":{"line":1,"column":205}},{"source":"lib/make-shapes.js","original":{"line":5,"column":26},"generated":{"line":1,"column":207}},{"source":"lib/make-shapes.js","name":"acc","original":{"line":5,"column":27},"generated":{"line":1,"column":208}},{"source":"lib/make-shapes.js","name":"piece","original":{"line":5,"column":32},"generated":{"line":1,"column":210}},{"source":"lib/make-shapes.js","name":"getNeighbor","original":{"line":6,"column":8},"generated":{"line":1,"column":215}},{"source":"lib/make-shapes.js","name":"getNeighbor","original":{"line":6,"column":8},"generated":{"line":1,"column":221}},{"source":"lib/make-shapes.js","name":"id","original":{"line":6,"column":23},"generated":{"line":1,"column":223}},{"source":"lib/make-shapes.js","name":"acc","original":{"line":6,"column":30},"generated":{"line":1,"column":226}},{"source":"lib/make-shapes.js","name":"find","original":{"line":6,"column":34},"generated":{"line":1,"column":228}},{"source":"lib/make-shapes.js","name":"piece","original":{"line":6,"column":40},"generated":{"line":1,"column":233}},{"source":"lib/make-shapes.js","name":"piece","original":{"line":6,"column":50},"generated":{"line":1,"column":236}},{"source":"lib/make-shapes.js","name":"id","original":{"line":6,"column":56},"generated":{"line":1,"column":238}},{"source":"lib/make-shapes.js","name":"id","original":{"line":6,"column":63},"generated":{"line":1,"column":243}},{"source":"lib/make-shapes.js","name":"neighborShape","original":{"line":7,"column":8},"generated":{"line":1,"column":246}},{"source":"lib/make-shapes.js","original":{"line":7,"column":24},"generated":{"line":1,"column":248}},{"source":"lib/make-shapes.js","name":"id","original":{"line":7,"column":25},"generated":{"line":1,"column":249}},{"source":"lib/make-shapes.js","name":"side","original":{"line":7,"column":29},"generated":{"line":1,"column":251}},{"source":"lib/make-shapes.js","name":"getNeighbor","original":{"line":8,"column":4},"generated":{"line":1,"column":255}},{"source":"lib/make-shapes.js","name":"id","original":{"line":8,"column":16},"generated":{"line":1,"column":257}},{"source":"lib/make-shapes.js","name":"getNeighbor","original":{"line":9,"column":4},"generated":{"line":1,"column":261}},{"source":"lib/make-shapes.js","name":"id","original":{"line":9,"column":16},"generated":{"line":1,"column":263}},{"source":"lib/make-shapes.js","name":"shapes","original":{"line":9,"column":20},"generated":{"line":1,"column":266}},{"source":"lib/make-shapes.js","name":"getNeighbor","original":{"line":10,"column":4},"generated":{"line":1,"column":274}},{"source":"lib/make-shapes.js","name":"id","original":{"line":10,"column":16},"generated":{"line":1,"column":276}},{"source":"lib/make-shapes.js","name":"shapes","original":{"line":10,"column":20},"generated":{"line":1,"column":279}},{"source":"lib/make-shapes.js","original":{"line":10,"column":27},"generated":{"line":1,"column":287}},{"source":"lib/make-shapes.js","name":"side","original":{"line":10,"column":36},"generated":{"line":1,"column":289}},{"source":"lib/make-shapes.js","name":"side","original":{"line":10,"column":36},"generated":{"line":1,"column":291}},{"source":"lib/make-shapes.js","name":"side","original":{"line":10,"column":36},"generated":{"line":1,"column":301}},{"source":"lib/make-shapes.js","name":"shapes","original":{"line":34,"column":8},"generated":{"line":1,"column":305}},{"source":"lib/make-shapes.js","original":{"line":34,"column":17},"generated":{"line":1,"column":307}},{"source":"lib/make-shapes.js","original":{"line":19,"column":22},"generated":{"line":1,"column":311}},{"source":"lib/make-shapes.js","name":"neighbors","original":{"line":19,"column":25},"generated":{"line":1,"column":314}},{"source":"lib/make-shapes.js","name":"neighbors","original":{"line":19,"column":25},"generated":{"line":1,"column":324}},{"source":"lib/make-shapes.js","name":"width","original":{"line":19,"column":36},"generated":{"line":1,"column":326}},{"source":"lib/make-shapes.js","name":"width","original":{"line":19,"column":36},"generated":{"line":1,"column":332}},{"source":"lib/make-shapes.js","name":"height","original":{"line":19,"column":43},"generated":{"line":1,"column":334}},{"source":"lib/make-shapes.js","name":"height","original":{"line":19,"column":43},"generated":{"line":1,"column":341}},{"source":"lib/make-shapes.js","name":"Object","original":{"line":20,"column":4},"generated":{"line":1,"column":346}},{"source":"lib/make-shapes.js","name":"keys","original":{"line":20,"column":11},"generated":{"line":1,"column":353}},{"source":"lib/make-shapes.js","name":"neighbors","original":{"line":20,"column":16},"generated":{"line":1,"column":358}},{"source":"lib/make-shapes.js","name":"reduce","original":{"line":20,"column":27},"generated":{"line":1,"column":361}},{"source":"lib/make-shapes.js","original":{"line":21,"column":6},"generated":{"line":1,"column":368}},{"source":"lib/make-shapes.js","name":"acc","original":{"line":21,"column":7},"generated":{"line":1,"column":369}},{"source":"lib/make-shapes.js","name":"side","original":{"line":21,"column":12},"generated":{"line":1,"column":371}},{"source":"lib/make-shapes.js","original":{"line":21,"column":22},"generated":{"line":1,"column":376}},{"source":"lib/make-shapes.js","name":"side","original":{"line":22,"column":9},"generated":{"line":1,"column":377}},{"source":"lib/make-shapes.js","name":"side","original":{"line":22,"column":9},"generated":{"line":1,"column":378}},{"source":"lib/make-shapes.js","name":"neighborShape","original":{"line":22,"column":16},"generated":{"line":1,"column":381}},{"source":"lib/make-shapes.js","name":"neighbors","original":{"line":22,"column":30},"generated":{"line":1,"column":383}},{"source":"lib/make-shapes.js","name":"side","original":{"line":22,"column":40},"generated":{"line":1,"column":385}},{"source":"lib/make-shapes.js","name":"side","original":{"line":22,"column":47},"generated":{"line":1,"column":388}},{"source":"lib/make-shapes.js","original":{"line":23,"column":12},"generated":{"line":1,"column":392}},{"source":"lib/make-shapes.js","name":"neighborShape","original":{"line":23,"column":22},"generated":{"line":1,"column":394}},{"source":"lib/make-shapes.js","name":"neighborShape","original":{"line":23,"column":22},"generated":{"line":1,"column":396}},{"source":"lib/make-shapes.js","name":"neighborShape","original":{"line":23,"column":22},"generated":{"line":1,"column":407}},{"source":"lib/make-shapes.js","name":"neighbors","original":{"line":23,"column":36},"generated":{"line":1,"column":409}},{"source":"lib/make-shapes.js","name":"side","original":{"line":23,"column":46},"generated":{"line":1,"column":411}},{"source":"lib/make-shapes.js","name":"side","original":{"line":23,"column":53},"generated":{"line":1,"column":414}},{"source":"lib/make-shapes.js","original":{"line":24,"column":12},"generated":{"line":1,"column":419}},{"source":"lib/make-shapes.js","original":{"line":24,"column":24},"generated":{"line":1,"column":421}},{"source":"lib/make-shapes.js","original":{"line":24,"column":24},"generated":{"line":1,"column":423}},{"source":"lib/make-shapes.js","original":{"line":24,"column":24},"generated":{"line":1,"column":434}},{"source":"lib/make-shapes.js","original":{"line":25,"column":12},"generated":{"line":1,"column":438}},{"source":"lib/make-shapes.js","original":{"line":25,"column":19},"generated":{"line":1,"column":440}},{"source":"lib/make-shapes.js","original":{"line":25,"column":19},"generated":{"line":1,"column":442}},{"source":"lib/make-shapes.js","original":{"line":25,"column":19},"generated":{"line":1,"column":451}},{"source":"lib/make-shapes.js","name":"side","original":{"line":25,"column":30},"generated":{"line":1,"column":453}},{"source":"lib/make-shapes.js","name":"side","original":{"line":25,"column":30},"generated":{"line":1,"column":455}},{"source":"lib/make-shapes.js","name":"side","original":{"line":25,"column":30},"generated":{"line":1,"column":467}},{"source":"lib/make-shapes.js","name":"width","original":{"line":25,"column":38},"generated":{"line":1,"column":470}},{"source":"lib/make-shapes.js","name":"height","original":{"line":25,"column":46},"generated":{"line":1,"column":472}},{"source":"lib/make-shapes.js","name":"Math","original":{"line":25,"column":54},"generated":{"line":1,"column":474}},{"source":"lib/make-shapes.js","name":"min","original":{"line":25,"column":59},"generated":{"line":1,"column":479}},{"source":"lib/make-shapes.js","name":"width","original":{"line":25,"column":63},"generated":{"line":1,"column":483}},{"source":"lib/make-shapes.js","name":"height","original":{"line":25,"column":70},"generated":{"line":1,"column":485}},{"source":"lib/make-shapes.js","original":{"line":26,"column":12},"generated":{"line":1,"column":490}},{"source":"lib/make-shapes.js","original":{"line":27,"column":14},"generated":{"line":1,"column":492}},{"source":"lib/make-shapes.js","original":{"line":27,"column":14},"generated":{"line":1,"column":494}},{"source":"lib/make-shapes.js","original":{"line":27,"column":14},"generated":{"line":1,"column":506}},{"source":"lib/make-shapes.js","original":{"line":27,"column":21},"generated":{"line":1,"column":508}},{"source":"lib/make-shapes.js","original":{"line":27,"column":21},"generated":{"line":1,"column":510}},{"source":"lib/make-shapes.js","original":{"line":27,"column":21},"generated":{"line":1,"column":519}},{"source":"lib/make-shapes.js","name":"side","original":{"line":27,"column":32},"generated":{"line":1,"column":521}},{"source":"lib/make-shapes.js","name":"side","original":{"line":27,"column":32},"generated":{"line":1,"column":523}},{"source":"lib/make-shapes.js","name":"side","original":{"line":27,"column":32},"generated":{"line":1,"column":535}},{"source":"lib/make-shapes.js","name":"width","original":{"line":27,"column":40},"generated":{"line":1,"column":538}},{"source":"lib/make-shapes.js","name":"height","original":{"line":27,"column":48},"generated":{"line":1,"column":540}},{"source":"lib/make-shapes.js","name":"Math","original":{"line":27,"column":56},"generated":{"line":1,"column":542}},{"source":"lib/make-shapes.js","name":"min","original":{"line":27,"column":61},"generated":{"line":1,"column":547}},{"source":"lib/make-shapes.js","name":"width","original":{"line":27,"column":65},"generated":{"line":1,"column":551}},{"source":"lib/make-shapes.js","name":"height","original":{"line":27,"column":72},"generated":{"line":1,"column":553}},{"source":"lib/make-shapes.js","name":"acc","original":{"line":29,"column":11},"generated":{"line":1,"column":561}},{"source":"lib/make-shapes.js","original":{"line":31,"column":6},"generated":{"line":1,"column":565}},{"source":"lib/make-shapes.js","name":"shapedSides","original":{"line":35,"column":7},"generated":{"line":1,"column":569}},{"source":"lib/make-shapes.js","name":"piece","original":{"line":35,"column":19},"generated":{"line":1,"column":570}},{"source":"lib/make-shapes.js","original":{"line":13,"column":20},"generated":{"line":1,"column":576}},{"source":"lib/make-shapes.js","name":"neighbors","original":{"line":13,"column":23},"generated":{"line":1,"column":579}},{"source":"lib/make-shapes.js","name":"neighbors","original":{"line":13,"column":23},"generated":{"line":1,"column":589}},{"source":"lib/make-shapes.js","name":"allSides","original":{"line":14,"column":4},"generated":{"line":1,"column":594}},{"source":"lib/make-shapes.js","name":"filter","original":{"line":15,"column":7},"generated":{"line":1,"column":596}},{"source":"lib/make-shapes.js","name":"filter","original":{"line":15,"column":7},"generated":{"line":1,"column":605}},{"source":"lib/make-shapes.js","name":"side","original":{"line":15,"column":15},"generated":{"line":1,"column":612}},{"source":"lib/make-shapes.js","name":"Object","original":{"line":15,"column":25},"generated":{"line":1,"column":616}},{"source":"lib/make-shapes.js","name":"keys","original":{"line":15,"column":32},"generated":{"line":1,"column":623}},{"source":"lib/make-shapes.js","name":"neighbors","original":{"line":15,"column":37},"generated":{"line":1,"column":628}},{"source":"lib/make-shapes.js","name":"includes","original":{"line":15,"column":48},"generated":{"line":1,"column":631}},{"source":"lib/make-shapes.js","name":"side","original":{"line":15,"column":57},"generated":{"line":1,"column":640}},{"source":"lib/make-shapes.js","name":"reduce","original":{"line":16,"column":7},"generated":{"line":1,"column":644}},{"source":"lib/make-shapes.js","original":{"line":16,"column":14},"generated":{"line":1,"column":651}},{"source":"lib/make-shapes.js","name":"acc","original":{"line":16,"column":15},"generated":{"line":1,"column":652}},{"source":"lib/make-shapes.js","name":"side","original":{"line":16,"column":20},"generated":{"line":1,"column":654}},{"source":"lib/make-shapes.js","original":{"line":16,"column":30},"generated":{"line":1,"column":659}},{"source":"lib/make-shapes.js","name":"side","original":{"line":16,"column":33},"generated":{"line":1,"column":660}},{"source":"lib/make-shapes.js","name":"side","original":{"line":16,"column":33},"generated":{"line":1,"column":661}},{"source":"lib/make-shapes.js","original":{"line":16,"column":40},"generated":{"line":1,"column":664}},{"source":"lib/make-shapes.js","name":"acc","original":{"line":16,"column":51},"generated":{"line":1,"column":674}},{"source":"lib/make-shapes.js","original":{"line":16,"column":59},"generated":{"line":1,"column":678}},{"source":"lib/make-shapes.js","name":"flatSides","original":{"line":36,"column":7},"generated":{"line":1,"column":682}},{"source":"lib/make-shapes.js","name":"piece","original":{"line":36,"column":17},"generated":{"line":1,"column":683}},{"source":"lib/make-shapes.js","original":{"line":39,"column":9},"generated":{"line":1,"column":687}},{"source":"lib/make-shapes.js","original":{"line":39,"column":9},"generated":{"line":1,"column":693}},{"source":"lib/make-shapes.js","original":{"line":39,"column":10},"generated":{"line":1,"column":694}},{"source":"lib/make-shapes.js","name":"piece","original":{"line":39,"column":15},"generated":{"line":1,"column":698}},{"source":"lib/make-shapes.js","name":"shapes","original":{"line":39,"column":22},"generated":{"line":1,"column":700}},{"source":"lib/make-shapes.js","name":"shapes","original":{"line":39,"column":22},"generated":{"line":1,"column":707}},{"source":"lib/make-shapes.js","name":"acc","original":{"line":39,"column":35},"generated":{"line":1,"column":713}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":717}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":725}},{"source":"lib/make-shapes.js","original":{"line":5,"column":7},"generated":{"line":1,"column":736}}],"sources":{"lib/make-shapes.js":"import { allSides, opposite, isVertical, sw } from \"./../utils/sides.js\";\nimport { bezier, bezierInv } from \"./../utils/bezier.js\";\nimport { random } from \"./../utils/random.js\";\n\nexport const makeShapes = (acc, piece) => {\n  const getNeighbor = (id) => acc.find((piece) => piece.id === id);\n  const neighborShape = (id, side) =>\n    getNeighbor(id) &&\n    getNeighbor(id).shapes &&\n    getNeighbor(id).shapes[opposite(side)];\n\n  // 'flat' if no neighbor\n  const flatSides = ({ neighbors }) =>\n    allSides\n      .filter((side) => !Object.keys(neighbors).includes(side))\n      .reduce((acc, side) => ({ [side]: \"flat\", ...acc }), {});\n\n  // a random- or an inverse bezier if the neighbor has a shape\n  const shapedSides = ({ neighbors, width, height }) =>\n    Object.keys(neighbors).reduce(\n      (acc, side) => ({\n        [side]: neighborShape(neighbors[side], side) // neighbor has shape\n          ? bezierInv(neighborShape(neighbors[side], side)) // mirror that shape\n          : random() >= 0.5 // else 50/50\n          ? bezier(isVertical(side) ? width : height, Math.min(width, height)) // be 'outy'\n          : bezierInv(\n              bezier(isVertical(side) ? width : height, Math.min(width, height))\n            ), // or 'inny\n        ...acc,\n      }),\n      {}\n    );\n\n  const shapes = {\n    ...shapedSides(piece),\n    ...flatSides(piece),\n  };\n\n  return [{ ...piece, shapes }, ...acc];\n};\n"},"lineCount":null}},"error":null,"hash":"8c1c8dbd14f951d9f0641912b595e6fa","cacheData":{"env":{}}}