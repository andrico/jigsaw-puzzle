{"id":"xNGh","dependencies":[{"name":"/Users/erik/webdev/temp/jigsaw-puzzle/package.json","includedInParent":true,"mtime":1607410881326},{"name":"./../utils/array-helpers.js","loc":{"line":1,"column":50},"parent":"/Users/erik/webdev/temp/jigsaw-puzzle/src/lib/activate.js","resolved":"/Users/erik/webdev/temp/jigsaw-puzzle/src/utils/array-helpers.js"},{"name":"./../utils/object-helpers.js","loc":{"line":2,"column":25},"parent":"/Users/erik/webdev/temp/jigsaw-puzzle/src/lib/activate.js","resolved":"/Users/erik/webdev/temp/jigsaw-puzzle/src/utils/object-helpers.js"},{"name":"./../utils/run-if.js","loc":{"line":3,"column":22},"parent":"/Users/erik/webdev/temp/jigsaw-puzzle/src/lib/activate.js","resolved":"/Users/erik/webdev/temp/jigsaw-puzzle/src/utils/run-if.js"},{"name":"./../utils/pipe.js","loc":{"line":4,"column":21},"parent":"/Users/erik/webdev/temp/jigsaw-puzzle/src/lib/activate.js","resolved":"/Users/erik/webdev/temp/jigsaw-puzzle/src/utils/pipe.js"},{"name":"./../utils/tap.js","loc":{"line":5,"column":20},"parent":"/Users/erik/webdev/temp/jigsaw-puzzle/src/lib/activate.js","resolved":"/Users/erik/webdev/temp/jigsaw-puzzle/src/utils/tap.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.activate=void 0;var e=require(\"./../utils/array-helpers.js\"),s=require(\"./../utils/object-helpers.js\"),a=require(\"./../utils/run-if.js\"),i=require(\"./../utils/pipe.js\"),c=require(\"./../utils/tap.js\");const t=(e,s,a)=>(a.clientX-e.canvas.pos.x)*e.canvas.DPI>=s.curPos.x&&(a.clientX-e.canvas.pos.x)*e.canvas.DPI<=s.curPos.x+s.width,r=(e,s,a)=>(a.clientY-e.canvas.pos.y)*e.canvas.DPI>=s.curPos.y&&(a.clientY-e.canvas.pos.y)*e.canvas.DPI<=s.curPos.y+s.height,n=(e,s,a)=>t(e,s,a)&&r(e,s,a),v=(e,s,a)=>({x:(a.clientX-e.canvas.pos.x)*e.canvas.DPI-s.curPos.x,y:(a.clientY-e.canvas.pos.y)*e.canvas.DPI-s.curPos.y}),u=c=>t=>({...t,pieces:(0,i.pipe)((0,e.mapReverse)((e,a,i,r)=>({...e,active:!(r.find((0,s.isTruthy)(\"active\"))||!n(t,e,c))&&v(t,e,c)})),(0,e.mapReverse)((e,a,i)=>({...e,active:i.find(s=>s.active&&s.connections.includes(e.id))?v(t,e,c):!i.find((0,s.isTruthy)(\"active\"))&&t.puzzle.draggable?v(t,e,c):e.active})),(0,a.runIf)((0,e.sort)(e.activeLast))(e=>!t.puzzle.done&&e.filter(e=>e.active).length!==t.pieces.length))(t.pieces)});exports.activate=u;"},"sourceMaps":{"js":{"mappings":[{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":0}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":13}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":20}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":35}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":43}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":56}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":57}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":64}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":68}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":76}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":90}},{"source":"lib/activate.js","original":{"line":1,"column":0},"generated":{"line":1,"column":92}},{"source":"lib/activate.js","original":{"line":1,"column":0},"generated":{"line":1,"column":96}},{"source":"lib/activate.js","original":{"line":1,"column":0},"generated":{"line":1,"column":98}},{"source":"lib/activate.js","original":{"line":1,"column":0},"generated":{"line":1,"column":106}},{"source":"lib/activate.js","original":{"line":2,"column":0},"generated":{"line":1,"column":137}},{"source":"lib/activate.js","original":{"line":2,"column":0},"generated":{"line":1,"column":139}},{"source":"lib/activate.js","original":{"line":2,"column":0},"generated":{"line":1,"column":147}},{"source":"lib/activate.js","original":{"line":3,"column":0},"generated":{"line":1,"column":179}},{"source":"lib/activate.js","original":{"line":3,"column":0},"generated":{"line":1,"column":181}},{"source":"lib/activate.js","original":{"line":3,"column":0},"generated":{"line":1,"column":189}},{"source":"lib/activate.js","original":{"line":4,"column":0},"generated":{"line":1,"column":213}},{"source":"lib/activate.js","original":{"line":4,"column":0},"generated":{"line":1,"column":215}},{"source":"lib/activate.js","original":{"line":4,"column":0},"generated":{"line":1,"column":223}},{"source":"lib/activate.js","original":{"line":5,"column":0},"generated":{"line":1,"column":245}},{"source":"lib/activate.js","original":{"line":5,"column":0},"generated":{"line":1,"column":247}},{"source":"lib/activate.js","original":{"line":5,"column":0},"generated":{"line":1,"column":255}},{"source":"lib/activate.js","original":{"line":7,"column":0},"generated":{"line":1,"column":276}},{"source":"lib/activate.js","name":"isWithinX","original":{"line":7,"column":6},"generated":{"line":1,"column":282}},{"source":"lib/activate.js","original":{"line":7,"column":18},"generated":{"line":1,"column":284}},{"source":"lib/activate.js","name":"state","original":{"line":7,"column":19},"generated":{"line":1,"column":285}},{"source":"lib/activate.js","name":"piece","original":{"line":7,"column":26},"generated":{"line":1,"column":287}},{"source":"lib/activate.js","name":"e","original":{"line":7,"column":33},"generated":{"line":1,"column":289}},{"source":"lib/activate.js","name":"e","original":{"line":8,"column":3},"generated":{"line":1,"column":294}},{"source":"lib/activate.js","name":"clientX","original":{"line":8,"column":5},"generated":{"line":1,"column":296}},{"source":"lib/activate.js","name":"state","original":{"line":8,"column":15},"generated":{"line":1,"column":304}},{"source":"lib/activate.js","name":"canvas","original":{"line":8,"column":21},"generated":{"line":1,"column":306}},{"source":"lib/activate.js","name":"pos","original":{"line":8,"column":28},"generated":{"line":1,"column":313}},{"source":"lib/activate.js","name":"x","original":{"line":8,"column":32},"generated":{"line":1,"column":317}},{"source":"lib/activate.js","name":"state","original":{"line":8,"column":37},"generated":{"line":1,"column":320}},{"source":"lib/activate.js","name":"canvas","original":{"line":8,"column":43},"generated":{"line":1,"column":322}},{"source":"lib/activate.js","name":"DPI","original":{"line":8,"column":50},"generated":{"line":1,"column":329}},{"source":"lib/activate.js","name":"piece","original":{"line":8,"column":57},"generated":{"line":1,"column":334}},{"source":"lib/activate.js","name":"curPos","original":{"line":8,"column":63},"generated":{"line":1,"column":336}},{"source":"lib/activate.js","name":"x","original":{"line":8,"column":70},"generated":{"line":1,"column":343}},{"source":"lib/activate.js","name":"e","original":{"line":9,"column":3},"generated":{"line":1,"column":347}},{"source":"lib/activate.js","name":"clientX","original":{"line":9,"column":5},"generated":{"line":1,"column":349}},{"source":"lib/activate.js","name":"state","original":{"line":9,"column":15},"generated":{"line":1,"column":357}},{"source":"lib/activate.js","name":"canvas","original":{"line":9,"column":21},"generated":{"line":1,"column":359}},{"source":"lib/activate.js","name":"pos","original":{"line":9,"column":28},"generated":{"line":1,"column":366}},{"source":"lib/activate.js","name":"x","original":{"line":9,"column":32},"generated":{"line":1,"column":370}},{"source":"lib/activate.js","name":"state","original":{"line":9,"column":37},"generated":{"line":1,"column":373}},{"source":"lib/activate.js","name":"canvas","original":{"line":9,"column":43},"generated":{"line":1,"column":375}},{"source":"lib/activate.js","name":"DPI","original":{"line":9,"column":50},"generated":{"line":1,"column":382}},{"source":"lib/activate.js","name":"piece","original":{"line":10,"column":4},"generated":{"line":1,"column":387}},{"source":"lib/activate.js","name":"curPos","original":{"line":10,"column":10},"generated":{"line":1,"column":389}},{"source":"lib/activate.js","name":"x","original":{"line":10,"column":17},"generated":{"line":1,"column":396}},{"source":"lib/activate.js","name":"piece","original":{"line":10,"column":21},"generated":{"line":1,"column":398}},{"source":"lib/activate.js","name":"width","original":{"line":10,"column":27},"generated":{"line":1,"column":400}},{"source":"lib/activate.js","name":"isWithinY","original":{"line":12,"column":6},"generated":{"line":1,"column":406}},{"source":"lib/activate.js","original":{"line":12,"column":18},"generated":{"line":1,"column":408}},{"source":"lib/activate.js","name":"state","original":{"line":12,"column":19},"generated":{"line":1,"column":409}},{"source":"lib/activate.js","name":"piece","original":{"line":12,"column":26},"generated":{"line":1,"column":411}},{"source":"lib/activate.js","name":"e","original":{"line":12,"column":33},"generated":{"line":1,"column":413}},{"source":"lib/activate.js","name":"e","original":{"line":13,"column":3},"generated":{"line":1,"column":418}},{"source":"lib/activate.js","name":"clientY","original":{"line":13,"column":5},"generated":{"line":1,"column":420}},{"source":"lib/activate.js","name":"state","original":{"line":13,"column":15},"generated":{"line":1,"column":428}},{"source":"lib/activate.js","name":"canvas","original":{"line":13,"column":21},"generated":{"line":1,"column":430}},{"source":"lib/activate.js","name":"pos","original":{"line":13,"column":28},"generated":{"line":1,"column":437}},{"source":"lib/activate.js","name":"y","original":{"line":13,"column":32},"generated":{"line":1,"column":441}},{"source":"lib/activate.js","name":"state","original":{"line":13,"column":37},"generated":{"line":1,"column":444}},{"source":"lib/activate.js","name":"canvas","original":{"line":13,"column":43},"generated":{"line":1,"column":446}},{"source":"lib/activate.js","name":"DPI","original":{"line":13,"column":50},"generated":{"line":1,"column":453}},{"source":"lib/activate.js","name":"piece","original":{"line":13,"column":57},"generated":{"line":1,"column":458}},{"source":"lib/activate.js","name":"curPos","original":{"line":13,"column":63},"generated":{"line":1,"column":460}},{"source":"lib/activate.js","name":"y","original":{"line":13,"column":70},"generated":{"line":1,"column":467}},{"source":"lib/activate.js","name":"e","original":{"line":14,"column":3},"generated":{"line":1,"column":471}},{"source":"lib/activate.js","name":"clientY","original":{"line":14,"column":5},"generated":{"line":1,"column":473}},{"source":"lib/activate.js","name":"state","original":{"line":14,"column":15},"generated":{"line":1,"column":481}},{"source":"lib/activate.js","name":"canvas","original":{"line":14,"column":21},"generated":{"line":1,"column":483}},{"source":"lib/activate.js","name":"pos","original":{"line":14,"column":28},"generated":{"line":1,"column":490}},{"source":"lib/activate.js","name":"y","original":{"line":14,"column":32},"generated":{"line":1,"column":494}},{"source":"lib/activate.js","name":"state","original":{"line":14,"column":37},"generated":{"line":1,"column":497}},{"source":"lib/activate.js","name":"canvas","original":{"line":14,"column":43},"generated":{"line":1,"column":499}},{"source":"lib/activate.js","name":"DPI","original":{"line":14,"column":50},"generated":{"line":1,"column":506}},{"source":"lib/activate.js","name":"piece","original":{"line":15,"column":4},"generated":{"line":1,"column":511}},{"source":"lib/activate.js","name":"curPos","original":{"line":15,"column":10},"generated":{"line":1,"column":513}},{"source":"lib/activate.js","name":"y","original":{"line":15,"column":17},"generated":{"line":1,"column":520}},{"source":"lib/activate.js","name":"piece","original":{"line":15,"column":21},"generated":{"line":1,"column":522}},{"source":"lib/activate.js","name":"height","original":{"line":15,"column":27},"generated":{"line":1,"column":524}},{"source":"lib/activate.js","name":"isClicked","original":{"line":17,"column":6},"generated":{"line":1,"column":531}},{"source":"lib/activate.js","original":{"line":17,"column":18},"generated":{"line":1,"column":533}},{"source":"lib/activate.js","name":"state","original":{"line":17,"column":19},"generated":{"line":1,"column":534}},{"source":"lib/activate.js","name":"piece","original":{"line":17,"column":26},"generated":{"line":1,"column":536}},{"source":"lib/activate.js","name":"e","original":{"line":17,"column":33},"generated":{"line":1,"column":538}},{"source":"lib/activate.js","name":"isWithinX","original":{"line":18,"column":2},"generated":{"line":1,"column":542}},{"source":"lib/activate.js","name":"state","original":{"line":18,"column":12},"generated":{"line":1,"column":544}},{"source":"lib/activate.js","name":"piece","original":{"line":18,"column":19},"generated":{"line":1,"column":546}},{"source":"lib/activate.js","name":"e","original":{"line":18,"column":26},"generated":{"line":1,"column":548}},{"source":"lib/activate.js","name":"isWithinY","original":{"line":18,"column":32},"generated":{"line":1,"column":552}},{"source":"lib/activate.js","name":"state","original":{"line":18,"column":42},"generated":{"line":1,"column":554}},{"source":"lib/activate.js","name":"piece","original":{"line":18,"column":49},"generated":{"line":1,"column":556}},{"source":"lib/activate.js","name":"e","original":{"line":18,"column":56},"generated":{"line":1,"column":558}},{"source":"lib/activate.js","name":"getPiecePos","original":{"line":20,"column":6},"generated":{"line":1,"column":561}},{"source":"lib/activate.js","original":{"line":20,"column":20},"generated":{"line":1,"column":563}},{"source":"lib/activate.js","name":"state","original":{"line":20,"column":21},"generated":{"line":1,"column":564}},{"source":"lib/activate.js","name":"piece","original":{"line":20,"column":28},"generated":{"line":1,"column":566}},{"source":"lib/activate.js","name":"e","original":{"line":20,"column":35},"generated":{"line":1,"column":568}},{"source":"lib/activate.js","original":{"line":20,"column":42},"generated":{"line":1,"column":573}},{"source":"lib/activate.js","name":"x","original":{"line":21,"column":2},"generated":{"line":1,"column":574}},{"source":"lib/activate.js","name":"e","original":{"line":21,"column":6},"generated":{"line":1,"column":577}},{"source":"lib/activate.js","name":"clientX","original":{"line":21,"column":8},"generated":{"line":1,"column":579}},{"source":"lib/activate.js","name":"state","original":{"line":21,"column":18},"generated":{"line":1,"column":587}},{"source":"lib/activate.js","name":"canvas","original":{"line":21,"column":24},"generated":{"line":1,"column":589}},{"source":"lib/activate.js","name":"pos","original":{"line":21,"column":31},"generated":{"line":1,"column":596}},{"source":"lib/activate.js","name":"x","original":{"line":21,"column":35},"generated":{"line":1,"column":600}},{"source":"lib/activate.js","name":"state","original":{"line":21,"column":40},"generated":{"line":1,"column":603}},{"source":"lib/activate.js","name":"canvas","original":{"line":21,"column":46},"generated":{"line":1,"column":605}},{"source":"lib/activate.js","name":"DPI","original":{"line":21,"column":53},"generated":{"line":1,"column":612}},{"source":"lib/activate.js","name":"piece","original":{"line":21,"column":59},"generated":{"line":1,"column":616}},{"source":"lib/activate.js","name":"curPos","original":{"line":21,"column":65},"generated":{"line":1,"column":618}},{"source":"lib/activate.js","name":"x","original":{"line":21,"column":72},"generated":{"line":1,"column":625}},{"source":"lib/activate.js","name":"y","original":{"line":22,"column":2},"generated":{"line":1,"column":627}},{"source":"lib/activate.js","name":"e","original":{"line":22,"column":6},"generated":{"line":1,"column":630}},{"source":"lib/activate.js","name":"clientY","original":{"line":22,"column":8},"generated":{"line":1,"column":632}},{"source":"lib/activate.js","name":"state","original":{"line":22,"column":18},"generated":{"line":1,"column":640}},{"source":"lib/activate.js","name":"canvas","original":{"line":22,"column":24},"generated":{"line":1,"column":642}},{"source":"lib/activate.js","name":"pos","original":{"line":22,"column":31},"generated":{"line":1,"column":649}},{"source":"lib/activate.js","name":"y","original":{"line":22,"column":35},"generated":{"line":1,"column":653}},{"source":"lib/activate.js","name":"state","original":{"line":22,"column":40},"generated":{"line":1,"column":656}},{"source":"lib/activate.js","name":"canvas","original":{"line":22,"column":46},"generated":{"line":1,"column":658}},{"source":"lib/activate.js","name":"DPI","original":{"line":22,"column":53},"generated":{"line":1,"column":665}},{"source":"lib/activate.js","name":"piece","original":{"line":22,"column":59},"generated":{"line":1,"column":669}},{"source":"lib/activate.js","name":"curPos","original":{"line":22,"column":65},"generated":{"line":1,"column":671}},{"source":"lib/activate.js","name":"y","original":{"line":22,"column":72},"generated":{"line":1,"column":678}},{"source":"lib/activate.js","name":"activate","original":{"line":26,"column":13},"generated":{"line":1,"column":682}},{"source":"lib/activate.js","name":"e","original":{"line":26,"column":25},"generated":{"line":1,"column":684}},{"source":"lib/activate.js","name":"state","original":{"line":26,"column":32},"generated":{"line":1,"column":687}},{"source":"lib/activate.js","original":{"line":26,"column":43},"generated":{"line":1,"column":691}},{"source":"lib/activate.js","name":"state","original":{"line":27,"column":5},"generated":{"line":1,"column":695}},{"source":"lib/activate.js","name":"pieces","original":{"line":28,"column":2},"generated":{"line":1,"column":697}},{"source":"lib/activate.js","original":{"line":28,"column":10},"generated":{"line":1,"column":705}},{"source":"lib/activate.js","original":{"line":29,"column":4},"generated":{"line":1,"column":707}},{"source":"lib/activate.js","original":{"line":29,"column":4},"generated":{"line":1,"column":709}},{"source":"lib/activate.js","original":{"line":30,"column":15},"generated":{"line":1,"column":716}},{"source":"lib/activate.js","original":{"line":30,"column":15},"generated":{"line":1,"column":718}},{"source":"lib/activate.js","original":{"line":30,"column":15},"generated":{"line":1,"column":720}},{"source":"lib/activate.js","original":{"line":30,"column":15},"generated":{"line":1,"column":732}},{"source":"lib/activate.js","name":"piece","original":{"line":30,"column":16},"generated":{"line":1,"column":733}},{"source":"lib/activate.js","name":"i","original":{"line":30,"column":23},"generated":{"line":1,"column":735}},{"source":"lib/activate.js","name":"arr","original":{"line":30,"column":26},"generated":{"line":1,"column":737}},{"source":"lib/activate.js","name":"acc","original":{"line":30,"column":31},"generated":{"line":1,"column":739}},{"source":"lib/activate.js","original":{"line":30,"column":40},"generated":{"line":1,"column":744}},{"source":"lib/activate.js","name":"piece","original":{"line":31,"column":9},"generated":{"line":1,"column":748}},{"source":"lib/activate.js","name":"active","original":{"line":32,"column":6},"generated":{"line":1,"column":750}},{"source":"lib/activate.js","name":"acc","original":{"line":33,"column":9},"generated":{"line":1,"column":759}},{"source":"lib/activate.js","name":"find","original":{"line":33,"column":13},"generated":{"line":1,"column":761}},{"source":"lib/activate.js","original":{"line":33,"column":18},"generated":{"line":1,"column":767}},{"source":"lib/activate.js","original":{"line":33,"column":27},"generated":{"line":1,"column":769}},{"source":"lib/activate.js","original":{"line":33,"column":27},"generated":{"line":1,"column":771}},{"source":"lib/activate.js","original":{"line":33,"column":27},"generated":{"line":1,"column":781}},{"source":"lib/activate.js","name":"isClicked","original":{"line":33,"column":41},"generated":{"line":1,"column":794}},{"source":"lib/activate.js","name":"state","original":{"line":33,"column":51},"generated":{"line":1,"column":796}},{"source":"lib/activate.js","name":"piece","original":{"line":33,"column":58},"generated":{"line":1,"column":798}},{"source":"lib/activate.js","name":"e","original":{"line":33,"column":65},"generated":{"line":1,"column":800}},{"source":"lib/activate.js","name":"getPiecePos","original":{"line":34,"column":12},"generated":{"line":1,"column":805}},{"source":"lib/activate.js","name":"state","original":{"line":34,"column":24},"generated":{"line":1,"column":807}},{"source":"lib/activate.js","name":"piece","original":{"line":34,"column":31},"generated":{"line":1,"column":809}},{"source":"lib/activate.js","name":"e","original":{"line":34,"column":38},"generated":{"line":1,"column":811}},{"source":"lib/activate.js","original":{"line":38,"column":4},"generated":{"line":1,"column":818}},{"source":"lib/activate.js","original":{"line":38,"column":15},"generated":{"line":1,"column":820}},{"source":"lib/activate.js","original":{"line":38,"column":15},"generated":{"line":1,"column":822}},{"source":"lib/activate.js","original":{"line":38,"column":15},"generated":{"line":1,"column":834}},{"source":"lib/activate.js","name":"piece","original":{"line":38,"column":16},"generated":{"line":1,"column":835}},{"source":"lib/activate.js","name":"i","original":{"line":38,"column":23},"generated":{"line":1,"column":837}},{"source":"lib/activate.js","name":"arr","original":{"line":38,"column":26},"generated":{"line":1,"column":839}},{"source":"lib/activate.js","original":{"line":38,"column":35},"generated":{"line":1,"column":844}},{"source":"lib/activate.js","name":"piece","original":{"line":39,"column":9},"generated":{"line":1,"column":848}},{"source":"lib/activate.js","name":"active","original":{"line":41,"column":6},"generated":{"line":1,"column":850}},{"source":"lib/activate.js","name":"arr","original":{"line":41,"column":14},"generated":{"line":1,"column":857}},{"source":"lib/activate.js","name":"find","original":{"line":41,"column":18},"generated":{"line":1,"column":859}},{"source":"lib/activate.js","name":"p","original":{"line":41,"column":24},"generated":{"line":1,"column":864}},{"source":"lib/activate.js","name":"p","original":{"line":41,"column":30},"generated":{"line":1,"column":867}},{"source":"lib/activate.js","name":"active","original":{"line":41,"column":32},"generated":{"line":1,"column":869}},{"source":"lib/activate.js","name":"p","original":{"line":41,"column":42},"generated":{"line":1,"column":877}},{"source":"lib/activate.js","name":"connections","original":{"line":41,"column":44},"generated":{"line":1,"column":879}},{"source":"lib/activate.js","name":"includes","original":{"line":41,"column":56},"generated":{"line":1,"column":891}},{"source":"lib/activate.js","name":"piece","original":{"line":41,"column":65},"generated":{"line":1,"column":900}},{"source":"lib/activate.js","name":"id","original":{"line":41,"column":71},"generated":{"line":1,"column":902}},{"source":"lib/activate.js","name":"getPiecePos","original":{"line":42,"column":10},"generated":{"line":1,"column":907}},{"source":"lib/activate.js","name":"state","original":{"line":42,"column":22},"generated":{"line":1,"column":909}},{"source":"lib/activate.js","name":"piece","original":{"line":42,"column":29},"generated":{"line":1,"column":911}},{"source":"lib/activate.js","name":"e","original":{"line":42,"column":36},"generated":{"line":1,"column":913}},{"source":"lib/activate.js","name":"arr","original":{"line":44,"column":9},"generated":{"line":1,"column":917}},{"source":"lib/activate.js","name":"find","original":{"line":44,"column":13},"generated":{"line":1,"column":919}},{"source":"lib/activate.js","original":{"line":44,"column":18},"generated":{"line":1,"column":925}},{"source":"lib/activate.js","original":{"line":44,"column":27},"generated":{"line":1,"column":927}},{"source":"lib/activate.js","original":{"line":44,"column":27},"generated":{"line":1,"column":929}},{"source":"lib/activate.js","original":{"line":44,"column":27},"generated":{"line":1,"column":939}},{"source":"lib/activate.js","name":"state","original":{"line":44,"column":41},"generated":{"line":1,"column":951}},{"source":"lib/activate.js","name":"puzzle","original":{"line":44,"column":47},"generated":{"line":1,"column":953}},{"source":"lib/activate.js","name":"draggable","original":{"line":44,"column":54},"generated":{"line":1,"column":960}},{"source":"lib/activate.js","name":"getPiecePos","original":{"line":45,"column":10},"generated":{"line":1,"column":970}},{"source":"lib/activate.js","name":"state","original":{"line":45,"column":22},"generated":{"line":1,"column":972}},{"source":"lib/activate.js","name":"piece","original":{"line":45,"column":29},"generated":{"line":1,"column":974}},{"source":"lib/activate.js","name":"e","original":{"line":45,"column":36},"generated":{"line":1,"column":976}},{"source":"lib/activate.js","name":"piece","original":{"line":46,"column":10},"generated":{"line":1,"column":979}},{"source":"lib/activate.js","name":"active","original":{"line":46,"column":16},"generated":{"line":1,"column":981}},{"source":"lib/activate.js","original":{"line":51,"column":10},"generated":{"line":1,"column":992}},{"source":"lib/activate.js","original":{"line":51,"column":10},"generated":{"line":1,"column":994}},{"source":"lib/activate.js","original":{"line":51,"column":10},"generated":{"line":1,"column":996}},{"source":"lib/activate.js","original":{"line":51,"column":10},"generated":{"line":1,"column":1004}},{"source":"lib/activate.js","name":"activeLast","original":{"line":51,"column":15},"generated":{"line":1,"column":1006}},{"source":"lib/activate.js","name":"activeLast","original":{"line":51,"column":15},"generated":{"line":1,"column":1008}},{"source":"lib/activate.js","name":"activeLast","original":{"line":51,"column":15},"generated":{"line":1,"column":1014}},{"source":"lib/activate.js","original":{"line":51,"column":10},"generated":{"line":1,"column":1016}},{"source":"lib/activate.js","original":{"line":51,"column":10},"generated":{"line":1,"column":1028}},{"source":"lib/activate.js","name":"ps","original":{"line":52,"column":7},"generated":{"line":1,"column":1029}},{"source":"lib/activate.js","name":"state","original":{"line":53,"column":9},"generated":{"line":1,"column":1033}},{"source":"lib/activate.js","name":"puzzle","original":{"line":53,"column":15},"generated":{"line":1,"column":1035}},{"source":"lib/activate.js","name":"done","original":{"line":53,"column":22},"generated":{"line":1,"column":1042}},{"source":"lib/activate.js","name":"ps","original":{"line":54,"column":8},"generated":{"line":1,"column":1048}},{"source":"lib/activate.js","name":"filter","original":{"line":54,"column":11},"generated":{"line":1,"column":1050}},{"source":"lib/activate.js","name":"p","original":{"line":54,"column":19},"generated":{"line":1,"column":1057}},{"source":"lib/activate.js","name":"p","original":{"line":54,"column":25},"generated":{"line":1,"column":1060}},{"source":"lib/activate.js","name":"active","original":{"line":54,"column":27},"generated":{"line":1,"column":1062}},{"source":"lib/activate.js","name":"length","original":{"line":54,"column":35},"generated":{"line":1,"column":1070}},{"source":"lib/activate.js","name":"state","original":{"line":54,"column":46},"generated":{"line":1,"column":1079}},{"source":"lib/activate.js","name":"pieces","original":{"line":54,"column":52},"generated":{"line":1,"column":1081}},{"source":"lib/activate.js","name":"length","original":{"line":54,"column":59},"generated":{"line":1,"column":1088}},{"source":"lib/activate.js","original":{"line":28,"column":10},"generated":{"line":1,"column":1096}},{"source":"lib/activate.js","name":"state","original":{"line":56,"column":4},"generated":{"line":1,"column":1097}},{"source":"lib/activate.js","name":"pieces","original":{"line":56,"column":10},"generated":{"line":1,"column":1099}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":1109}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":1117}},{"source":"lib/activate.js","original":{"line":26,"column":7},"generated":{"line":1,"column":1126}}],"sources":{"lib/activate.js":"import { activeLast, mapReverse, sort, map } from \"./../utils/array-helpers.js\";\nimport { isTruthy } from \"./../utils/object-helpers.js\";\nimport { runIf } from \"./../utils/run-if.js\";\nimport { pipe } from \"./../utils/pipe.js\";\nimport { tap } from \"./../utils/tap.js\";\n\nconst isWithinX = (state, piece, e) =>\n  (e.clientX - state.canvas.pos.x) * state.canvas.DPI >= piece.curPos.x &&\n  (e.clientX - state.canvas.pos.x) * state.canvas.DPI <=\n    piece.curPos.x + piece.width;\n\nconst isWithinY = (state, piece, e) =>\n  (e.clientY - state.canvas.pos.y) * state.canvas.DPI >= piece.curPos.y &&\n  (e.clientY - state.canvas.pos.y) * state.canvas.DPI <=\n    piece.curPos.y + piece.height;\n\nconst isClicked = (state, piece, e) =>\n  isWithinX(state, piece, e) && isWithinY(state, piece, e);\n\nconst getPiecePos = (state, piece, e) => ({\n  x: (e.clientX - state.canvas.pos.x) * state.canvas.DPI - piece.curPos.x,\n  y: (e.clientY - state.canvas.pos.y) * state.canvas.DPI - piece.curPos.y,\n});\n\n// pieces gets painted bottom to top, we need to check in reverse order\nexport const activate = (e) => (state) => ({\n  ...state,\n  pieces: pipe(\n    // activate clicked piece (first occurence)\n    mapReverse((piece, i, arr, acc) => ({\n      ...piece,\n      active:\n        !acc.find(isTruthy(\"active\")) && isClicked(state, piece, e)\n          ? getPiecePos(state, piece, e)\n          : false,\n    })),\n\n    mapReverse((piece, i, arr) => ({\n      ...piece,\n      // activate the active piece's connections\n      active: arr.find((p) => p.active && p.connections.includes(piece.id))\n        ? getPiecePos(state, piece, e)\n        : // activate all pieces if none was clicked (and puzzle is draggable)\n        !arr.find(isTruthy(\"active\")) && state.puzzle.draggable\n        ? getPiecePos(state, piece, e)\n        : piece.active,\n    })),\n\n    // put the active piece(s) on top\n    // if puzzle isn't done or not all pieces are active (puzzle dragged)\n    runIf(sort(activeLast))(\n      (ps) =>\n        !state.puzzle.done &&\n        ps.filter((p) => p.active).length !== state.pieces.length\n    )\n  )(state.pieces),\n});\n"},"lineCount":null}},"error":null,"hash":"5421fa44f88e940122d5bb74991eff2f","cacheData":{"env":{}}}