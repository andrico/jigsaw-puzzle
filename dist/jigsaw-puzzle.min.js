parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"hZBy":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.$=void 0;const e=e=>document.querySelector(e);exports.$=e;
},{}],"ZnGg":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.pipe=void 0;const e=(...e)=>p=>[...e].reduce((e,p)=>p(e),p);exports.pipe=e;
},{}],"BphK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.tap=void 0;const e=e=>t=>(e(t),t);exports.tap=e;
},{}],"LmCC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.event=void 0;const e=(e,t,n)=>{const o=n;return t.addEventListener(e,n),{remove:()=>t.removeEventListener(e,o)}};function t(e){var t=e.changedTouches[0],n=new MouseEvent({touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup"}[e.type],{bubbles:!0,cancelable:!0,view:window,detail:1,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null});t.target.dispatchEvent(n)}function n(){document.addEventListener("touchstart",t,!0),document.addEventListener("touchmove",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("touchcancel",t,!0)}const o=t=>({scroll:t=>e("scroll",window,t),resize:t=>e("resize",window,t),click:n=>e("click",t.element,n),mousedown:n=>e("mousedown",t.element,n),mousemove:n=>e("mousemove",t.element,n),mouseup:t=>e("mouseup",document.body,t)});exports.event=o;
},{}],"e2v7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeCanvas=exports.updCanvas=void 0;const t=t=>{const{top:e,left:n}=t.canvas.element.getBoundingClientRect();return t.canvas.pos={x:n,y:e},t};exports.updCanvas=t;const e=t=>{const e=window.devicePixelRatio,n="CANVAS"===t.tagName?t:document.createElement("canvas"),a=n.getContext("2d"),s=document.createElement("canvas"),o=document.createElement("canvas"),{height:i,width:d}=getComputedStyle(t);n.width=s.width=o.width=parseInt(d,0)*e,n.height=s.height=o.height=parseInt(i,0)*e,n.style.width=s.style.width=o.style.width=parseInt(d,0)+"px",n.style.height=s.style.height=o.style.height=parseInt(i,0)+"px","CANVAS"!==t.tagName&&t.appendChild(n);const{top:h,left:c}=n.getBoundingClientRect();return{element:n,background:{canvas:s,ctx:s.getContext("2d")},foreground:{canvas:o,ctx:o.getContext("2d"),pos:{x:null,y:null}},ctx:a,pos:{x:c,y:h},width:n.width,height:n.height,DPI:e}};exports.makeCanvas=e;
},{}],"GEDr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loadImage=void 0;const e=e=>new Promise(o=>{var t=new Image;t.onload=(()=>o({image:t,width:t.width,height:t.height})),t.src=e});exports.loadImage=e;
},{}],"nCpN":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makePuzzle=void 0;const e=(e,t,i,o,h,d,a,r)=>{const{width:s,height:l}=getComputedStyle(o),n=t.width<t.height,c=window.devicePixelRatio,g=parseInt([n?l:s],0)/t[n?"height":"width"];return{timeStamp:Date.now(),done:!1,cols:e.x,rows:e.y,width:t.width*g*c,height:t.height*g*c,attraction:i,scale:g,occupy:h,draggable:d,aligned:a,onComplete:r}};exports.makePuzzle=e;
},{}],"E8ee":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.same=exports.removeNull=exports.isTruthy=void 0;const e=e=>t=>t[e];exports.isTruthy=e;const t=e=>{let t={};return Object.keys(e).forEach(s=>{null!==e[s]&&(t[s]=e[s])}),t};exports.removeNull=t;const s=(e,t)=>s=>s[e]===t;exports.same=s;
},{}],"Tv03":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getNeighbors=void 0;var e=require("./object-helpers.js");const t=(t,r,o)=>{const l=t+1,s={top:l>o?t-o:null,right:l%o!=0?t+1:null,bottom:l<=(r-1)*o?t+o:null,left:l%o!=1?t-1:null};return(0,e.removeNull)(s)};exports.getNeighbors=t;
},{"./object-helpers.js":"E8ee"}],"EOVc":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.nw=exports.sw=exports.isHorizontal=exports.isVertical=exports.opposite=exports.allSides=void 0;const t=["top","right","bottom","left"];exports.allSides=t;const o=t=>({top:"bottom",right:"left",bottom:"top",left:"right"})[t];exports.opposite=o;const e=t=>"top"===t||"bottom"===t;exports.isVertical=e;const s=t=>!e(t);exports.isHorizontal=s;const p=t=>"bottom"===t||"left"===t;exports.sw=p;const r=t=>"top"===t||"left"===t;exports.nw=r;
},{}],"UGTE":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.bezierInv=exports.bezier=void 0;const e=(e=100,c=100)=>{const x=c/110,y=e/2;return[{cx1:0,cy1:0,cx2:y-10*x,cy2:5*x,ex:y-13*x,ey:0*x},{cx1:y-13*x,cy1:0*x,cx2:y-10*x,cy2:-2*x,ex:y-12*x,ey:-5*x},{cx1:y-12*x,cy1:-5*x,cx2:y-30*x,cy2:-30*x,ex:y,ey:-30*x},{cx1:y,cy1:-30*x,cx2:y- -30*x,cy2:-31*x,ex:y- -12*x,ey:-5*x},{cx1:y- -12*x,cy1:-5*x,cx2:y- -10*x,cy2:-2*x,ex:y- -13*x,ey:0*x},{cx1:y- -13*x,cy1:0*x,cx2:y- -10*x,cy2:5*x,ex:e,ey:0*x}]};exports.bezier=e;const c=(e,c=1)=>e.map((e,x)=>({cx1:e.cx1*c,cy1:-1*e.cy1,cx2:e.cx2*c,cy2:-1*e.cy2,ex:e.ex*c,ey:-1*e.ey}));exports.bezierInv=c;
},{}],"w1ka":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.random=void 0;const e=(e=Math.random())=>.5*(Math.cos(6669.1337*Math.sin(1337.1337*(e+69)))+1);exports.random=e;
},{}],"qdKZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeShapes=void 0;var e=require("./../../utils/sides.js"),s=require("./../../utils/bezier.js"),i=require("./../../utils/random.js");const r=(r,t)=>{const a=e=>r.find(s=>s.id===e),n=(s,i)=>a(s)&&a(s).shapes&&a(s).shapes[(0,e.opposite)(i)],o={...(({neighbors:r,width:t,height:a})=>Object.keys(r).reduce((o,d)=>({[d]:n(r[d],d)?(0,s.bezierInv)(n(r[d],d)):(0,i.random)()>=.5?(0,s.bezier)((0,e.isVertical)(d)?t:a,Math.min(t,a)):(0,s.bezierInv)((0,s.bezier)((0,e.isVertical)(d)?t:a,Math.min(t,a))),...o}),{}))(t),...(({neighbors:s})=>e.allSides.filter(e=>!Object.keys(s).includes(e)).reduce((e,s)=>({[s]:"flat",...e}),{}))(t)};return[{...t,shapes:o},...r]};exports.makeShapes=r;
},{"./../../utils/sides.js":"EOVc","./../../utils/bezier.js":"UGTE","./../../utils/random.js":"w1ka"}],"AIfJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makePieces=void 0;var e=require("./../../utils/get-neighbors.js"),s=require("./make-shapes.js");const o=o=>{const r=[...Array(o.rows*o.cols)],c=o.width/o.cols*o.occupy,t=o.height/o.rows*o.occupy;return r.map((s,r)=>({id:r,orgPos:{x:r%o.cols*c,y:Math.floor(r/o.cols)*t},curPos:{x:0,y:0},width:c,height:t,neighbors:(0,e.getNeighbors)(r,o.rows,o.cols),active:!1,connections:[]})).reduce(s.makeShapes,[])};exports.makePieces=o;
},{"./../../utils/get-neighbors.js":"Tv03","./make-shapes.js":"qdKZ"}],"v6Oc":[function(require,module,exports) {
"use strict";function e(e){const t=[...e];let r=t.length;for(;r>0;){let e=Math.floor(Math.random()*r),o=t[--r];t[r]=t[e],t[e]=o}return t}Object.defineProperty(exports,"__esModule",{value:!0}),exports.shuffleArray=e;
},{}],"QWdw":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shuffle=void 0;var e=require("./../../utils/random.js"),s=require("./../../utils/shuffleArray.js");const i=i=>({...i,pieces:i.puzzle.aligned?(0,s.shuffleArray)(i.pieces).map((e,s)=>({...e,connections:[],curPos:{x:s%i.puzzle.cols*i.pieces[0].width*1.5,y:Math.floor(s/i.puzzle.cols)*i.pieces[0].height*1.5}})):i.pieces.map((s,r)=>({...s,connections:[],curPos:{x:(0,e.random)()*(i.canvas.width-i.pieces[0].width),y:(0,e.random)()*(i.canvas.height-i.pieces[0].height)}}))});exports.shuffle=i;
},{"./../../utils/random.js":"w1ka","./../../utils/shuffleArray.js":"v6Oc"}],"lzTd":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.sort=exports.mapReverse=exports.map=exports.reverse=exports.connectedFirst=exports.activeLast=exports.randomElement=exports.filterUniqe=exports.shuffle=void 0;const{floor:e,random:t}=Math,s=e=>e.map(e=>[t(),e]).sort((e,t)=>e[0]-t[0]).map(e=>e[1]);exports.shuffle=s;const o=e=>[...new Set(e)];exports.filterUniqe=o;const r=s=>s[e(t()*s.length)];exports.randomElement=r;const n=(e,t)=>t.active?-1:1;exports.activeLast=n;const p=(e,t)=>e.connections.length>t.connections.length?-1:1;exports.connectedFirst=p;const c=e=>e.slice(0).reverse();exports.reverse=c;const x=e=>t=>t.map(e);exports.map=x;const a=e=>t=>t.reduceRight((t,s,o,r)=>[...t,e(s,o,r,t)],[]);exports.mapReverse=a;const i=e=>t=>t.sort(e);exports.sort=i;
},{}],"hHTC":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.paintPiece=void 0;var e=require("../../utils/sides.js");const t=(t,a)=>s=>{const{image:i}=t.image,{ctx:r,DPI:h=2}=a||t.canvas,{scale:c,occupy:n}=t.puzzle,l=Math.max(s.width,s.height);r.save(),r.beginPath(),r.translate(s.curPos.x,s.curPos.y+s.height),e.allSides.forEach(e=>{o(r,s.shapes[e],{x:"top"===e||"bottom"===e?-s.height:-s.width,y:"top"===e||"bottom"===e?s.width:s.height})}),r.closePath(),r.clip(),r.drawImage(i,(s.orgPos.x-l)/c/h/n,(s.orgPos.y-l)/c/h/n,(s.width+2*l)/c/h/n,(s.height+2*l)/c/h/n,s.curPos.x/t.canvas.width-l,s.curPos.y/t.canvas.height-l-s.height,s.width+2*l,s.height+2*l),r.restore();const d=!t.puzzle.done&&(s.active||s.alsoActive);r.shadowColor=d?"rgba(100, 100, 100, 1)":"rgba(50, 50, 50, 1)",r.strokeStyle=d?"rgba(225, 225, 225, 1)":"rgba(220, 220, 220, 1)",r.shadowBlur=d?2:1,r.lineWidth=d?2:1,r.shadowOffsetX=r.shadowOffsetY=-1,r.lineCap="round",r.lineJoin="round",r.stroke()};function o(e,t,o){e.translate(0,o.x),"flat"===t?e.lineTo(o.y,0):t.forEach(t=>{e.bezierCurveTo(t.cx1,t.cy1,t.cx2,t.cy2,t.ex,t.ey)}),e.rotate(Math.PI/2)}exports.paintPiece=t;
},{"../../utils/sides.js":"EOVc"}],"jJek":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clearCanvas=void 0;const e=(e,a)=>(a.clearRect(0,0,e.canvas.width,e.canvas.height),a);exports.clearCanvas=e;
},{}],"O9FZ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.paintLayers=void 0;var e=require("../../utils/array-helpers"),a=require("./paint-piece");const r=r=>{r.canvas.ctx.drawImage(r.canvas.background.canvas,0,0);const t=r.pieces.filter(({active:e})=>e);(0,e.map)((0,a.paintPiece)(r))(t)};exports.paintLayers=r;
},{"../../utils/array-helpers":"lzTd","./paint-piece":"hHTC"}],"TT8H":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.paint=void 0;var e=require("../../utils/array-helpers.js"),r=require("../../utils/tap.js"),a=require("./paint-piece.js"),s=require("./clear-canvas.js"),t=require("./paint-layers.js");const i=(0,r.tap)(e=>{(0,s.clearCanvas)(e,e.canvas.ctx),(0,t.paintLayers)(e)});exports.paint=i;
},{"../../utils/array-helpers.js":"lzTd","../../utils/tap.js":"BphK","./paint-piece.js":"hHTC","./clear-canvas.js":"jJek","./paint-layers.js":"O9FZ"}],"O7JW":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.runIf=void 0;const e=e=>t=>o=>("function"==typeof t?t(o):t)?e(o):o;exports.runIf=e;
},{}],"H5q6":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isUnderCursor=exports.isWithinY=exports.isWithinX=void 0;const s=(s,t,i)=>(i.clientX-s.canvas.pos.x)*s.canvas.DPI>=t.curPos.x&&(i.clientX-s.canvas.pos.x)*s.canvas.DPI<=t.curPos.x+t.width;exports.isWithinX=s;const t=(s,t,i)=>(i.clientY-s.canvas.pos.y)*s.canvas.DPI>=t.curPos.y&&(i.clientY-s.canvas.pos.y)*s.canvas.DPI<=t.curPos.y+t.height;exports.isWithinY=t;const i=(i,o,e)=>s(i,o,e)&&t(i,o,e);exports.isUnderCursor=i;
},{}],"OVt2":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.activate=void 0;var e=require("../../utils/array-helpers.js"),i=require("../../utils/object-helpers.js"),s=require("../../utils/run-if.js"),r=require("../../utils/pipe.js"),t=require("../../utils/is-under-cursor.js");const a=(e,i,s)=>({x:(s.clientX-e.canvas.pos.x)*e.canvas.DPI-i.curPos.x,y:(s.clientY-e.canvas.pos.y)*e.canvas.DPI-i.curPos.y}),c=c=>u=>({...u,pieces:(0,r.pipe)((0,e.mapReverse)((e,s,r,n)=>({...e,active:!(n.find((0,i.isTruthy)("active"))||!(0,t.isUnderCursor)(u,e,c))&&a(u,e,c)})),(0,e.mapReverse)((e,s,r)=>({...e,active:r.find(i=>i.active&&i.connections.includes(e.id))?a(u,e,c):!r.find((0,i.isTruthy)("active"))&&u.puzzle.draggable?a(u,e,c):e.active})),(0,s.runIf)((0,e.sort)(e.activeLast))(e=>!u.puzzle.done&&e.filter(e=>e.active).length!==u.pieces.length))(u.pieces)});exports.activate=c;
},{"../../utils/array-helpers.js":"lzTd","../../utils/object-helpers.js":"E8ee","../../utils/run-if.js":"O7JW","../../utils/pipe.js":"ZnGg","../../utils/is-under-cursor.js":"H5q6"}],"bOwK":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.deactivate=void 0;const e=e=>({...e,pieces:e.pieces.map(e=>({...e,active:!1}))});exports.deactivate=e;
},{}],"B4mP":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.move=void 0;const e=({clientX:e,clientY:s})=>c=>({...c,pieces:c.pieces.map(a=>({...a,curPos:a.active?{x:(e-c.canvas.pos.x)*c.canvas.DPI-a.active.x,y:(s-c.canvas.pos.y)*c.canvas.DPI-a.active.y}:a.curPos}))});exports.move=e;
},{}],"iDUR":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.shareConnections=void 0;var n=require("./../../utils/array-helpers.js");const e=(e,o,i)=>{o.connections=(0,n.filterUniqe)([o.id,i.id,...o.connections,...i.connections]),o.connections.forEach(i=>{e.pieces.find(n=>n.id===i).connections=(0,n.filterUniqe)(o.connections)}),i.connections.forEach(i=>{e.pieces.find(n=>n.id===i).connections=(0,n.filterUniqe)(o.connections)})};exports.shareConnections=e;
},{"./../../utils/array-helpers.js":"lzTd"}],"DS9U":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isClose=void 0;var s=require("./../../utils/sides.js");const r=(r,e,o,t)=>{const{attraction:u}=o.puzzle,c=(0,s.isVertical)(t)?"y":"x",i="x"===c?"y":"x",P=!(0,s.nw)(t),l=r["y"===c?"height":"width"],n=P?e.curPos[c]+l:e.curPos[c]-l;return r.curPos[c]<=n+u&&r.curPos[c]>=n-u&&r.curPos[i]<=e.curPos[i]+u&&r.curPos[i]>=e.curPos[i]-u};exports.isClose=r;
},{"./../../utils/sides.js":"EOVc"}],"ioHo":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.snap=void 0;var e=require("./share-connections.js"),s=require("./is-close.js"),o=require("./../../utils/object-helpers.js");const t=(e,[...s],t)=>{s.forEach(s=>{const r=e.pieces.find((0,o.same)("id",s));r.curPos={x:r.curPos.x+t.x,y:r.curPos.y+t.y}})},r=r=>{const c=r.pieces.filter(e=>e.active);return c.length&&c.length!==r.pieces.length?(c.forEach(c=>{Object.entries(c.neighbors).forEach(([i,n])=>{const h=r.pieces.find((0,o.same)("id",n));if((0,s.isClose)(h,c,r,i)){const s={x:h.curPos.x+("right"===i?-h.width:"left"===i?+h.width:0),y:h.curPos.y+("top"===i?h.height:"bottom"===i?-h.height:0)};t(r,c.connections,{x:s.x-c.curPos.x,y:s.y-c.curPos.y}),c.curPos=s,(0,e.shareConnections)(r,c,h)}})}),r):r};exports.snap=r;
},{"./share-connections.js":"iDUR","./is-close.js":"DS9U","./../../utils/object-helpers.js":"E8ee"}],"fjpq":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.status=void 0;const e=e=>(e.pieces[0].connections.length!==e.puzzle.rows*e.puzzle.cols||e.puzzle.done||(e.puzzle.done=!0,e.puzzle.onComplete(e)),e);exports.status=e;
},{}],"Po9z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.gather=void 0;const e=e=>(e.pieces=e.pieces.map(s=>({...s,curPos:{x:s.curPos.x-s.width>e.canvas.width*e.canvas.DPI?e.canvas.width-s.width:s.curPos.x,y:s.curPos.y-s.height>e.canvas.height*e.canvas.DPI?e.canvas.height-s.height:s.curPos.y}})),e);exports.gather=e;
},{}],"Gh4z":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.clone=void 0;const e=e=>({image:e.image,canvas:e.canvas,pieces:JSON.parse(JSON.stringify(e.pieces)),puzzle:JSON.parse(JSON.stringify(e.puzzle))});exports.clone=e;
},{}],"o99t":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.makeLayers=void 0;var e=require("./paint-piece.js"),a=require("./clear-canvas.js"),r=require("../../utils/array-helpers.js"),c=require("../../utils/tap.js");const s=(0,c.tap)(c=>{c.canvas.background.ctx=(0,a.clearCanvas)(c,c.canvas.background.ctx),c.canvas.foreground.ctx=(0,a.clearCanvas)(c,c.canvas.foreground.ctx),(0,r.map)((0,e.paintPiece)(c,{ctx:c.canvas.background.ctx}))(c.pieces.filter(({active:e})=>!e)),(0,r.map)((0,e.paintPiece)(c,{ctx:c.canvas.foreground.ctx}))(c.pieces.filter(({active:e})=>e))});exports.makeLayers=s;
},{"./paint-piece.js":"hHTC","./clear-canvas.js":"jJek","../../utils/array-helpers.js":"lzTd","../../utils/tap.js":"BphK"}],"PXdr":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.setCursor=exports.getCursor=void 0;var r=require("../../utils/is-under-cursor.js"),e=require("../../utils/tap.js");const s=s=>(0,e.tap)(e=>{const t=e.pieces.find(t=>(0,r.isUnderCursor)(e,t,s)),o=e.pieces.find(r=>r.active),a=e.pieces.every(r=>r.active);!o||a?!t||o?e.puzzle.draggable&&(e.canvas.cursor="move"):e.canvas.cursor="grab":e.canvas.cursor="grabbing"});exports.getCursor=s;const t=(0,e.tap)(r=>{r.canvas.element.style.cursor=r.canvas.cursor});exports.setCursor=t;
},{"../../utils/is-under-cursor.js":"H5q6","../../utils/tap.js":"BphK"}],"xfTU":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.moveForeground=void 0;var o=require("./../../utils/tap.js");const e=({clientX:e,clientY:s})=>(0,o.tap)(o=>{o.canvas.foreground.pos={x:(e-o.canvas.pos.x)*o.canvas.DPI-o.canvas.foreground.pos.x,y:(s-o.canvas.pos.y)*o.canvas.DPI-o.canvas.foreground.pos.y}});exports.moveForeground=e;
},{"./../../utils/tap.js":"BphK"}],"qbmb":[function(require,module,exports) {
(()=>{if(!function(){const t=document.createElement("canvas").getContext("2d");t.fillRect(0,0,40,40),t.drawImage(t.canvas,-40,-40,80,80,50,50,20,20);const e=t.getImageData(50,50,30,30),a=new Uint32Array(e.data.buffer),n=(t,n)=>a[n*e.width+t];return[[9,9],[20,9],[9,20],[20,20]].some(([t,e])=>0!==n(t,e))||[[10,10],[19,10],[10,19],[19,19]].some(([t,e])=>0===n(t,e))}())return;const t=CanvasRenderingContext2D.prototype,e=t.drawImage;e?t.drawImage=function(t,a,n){if(!(9===arguments.length))return e.apply(this,[...arguments]);const r=function(t,e,a,n,r,i,o,s,h){const{width:m,height:c}=function(t){const e=e=>{const a=globalThis[e];return a&&t instanceof a};if(e("HTMLImageElement"))return{width:t.naturalWidth,height:t.naturalHeight};if(e("HTMLVideoElement"))return{width:t.videoWidth,height:t.videoHeight};if(e("SVGImageElement"))throw new TypeError("SVGImageElement isn't yet supported as source image.","UnsupportedError");if(e("HTMLCanvasElement")||e("ImageBitmap"))return t}(t);n<0&&(e+=n,n=Math.abs(n));r<0&&(a+=r,r=Math.abs(r));s<0&&(i+=s,s=Math.abs(s));h<0&&(o+=h,h=Math.abs(h));const u=Math.max(e,0),d=Math.min(e+n,m),g=Math.max(a,0),l=Math.min(a+r,c),f=s/n,p=h/r;return[t,u,g,d-u,l-g,e<0?i-e*f:i,a<0?o-a*p:o,(d-u)*f,(l-g)*p]}(...arguments);var i;return i=r,[3,4,7,8].some(t=>!i[t])?void 0:e.apply(this,r)}:console.error("This script requires a basic implementation of drawImage")})();
},{}],"Focm":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=exports.puzzle=void 0;var e=require("./utils/dom.js"),r=require("./utils/pipe.js"),a=require("./utils/tap.js"),s=require("./utils/event-listeners.js"),i=require("./lib/canvas/make-canvas.js"),t=require("./lib/canvas/load-image.js"),o=require("./lib/core/make-puzzle.js"),n=require("./lib/core/make-pieces.js"),u=require("./lib/core/shuffle.js"),p=require("./lib/canvas/paint.js"),l=require("./lib/core/activate.js"),c=require("./lib/core/deactivate.js"),v=require("./lib/core/move.js"),m=require("./lib/core/snap.js"),d=require("./lib/core/status.js"),j=require("./lib/core/gather.js"),g=require("./lib/core/clone.js"),q=require("./lib/canvas/make-layers.js"),b=require("./lib/canvas/cursor.js"),f=require("./lib/core/move-foreground.js");require("./utils/safariDrawImageFix.js");const z=async({element:z,restore:C={},image:y="",pieces:k={x:6,y:4},attraction:w=20,size:x=.8,draggable:h=!1,aligned:L=!1,onComplete:P=(()=>{}),onChange:S=(()=>{})})=>{const A="string"==typeof z?(0,e.$)(z):z;if(!A)return void console.warn(`Couldn't find element: ${z}`);const F=(0,i.makeCanvas)(A),I=C.image||await(0,t.loadImage)(y),N=()=>C.puzzle||(0,o.makePuzzle)(k,I,w,A,x,h,L,P),$=C.pieces||(0,n.makePieces)(N()),_="function"==typeof S&&(0,a.tap)((0,r.pipe)(g.clone,S)),D=()=>({image:I,canvas:F,pieces:$,puzzle:N()});let G=D();console.log(G),G=C.puzzle?(0,r.pipe)(p.paint)(G):(0,r.pipe)(u.shuffle,q.makeLayers,p.paint)(G);const M=[(0,s.event)(window).resize(e=>G=(0,r.pipe)(i.updCanvas,j.gather,p.paint)(G)),(0,s.event)(window).scroll(e=>G=(0,r.pipe)(i.updCanvas)(G)),(0,s.event)(G.canvas).mousedown(e=>G=(0,r.pipe)((0,l.activate)(e),(0,b.getCursor)(e),b.setCursor,q.makeLayers,p.paint)(G)),(0,s.event)(G.canvas).mousemove(e=>{G=(0,r.pipe)((0,b.getCursor)(e),(0,v.move)(e),(0,f.moveForeground)(e),p.paint,b.setCursor)(G)}),(0,s.event)(document.body).mouseup(e=>G=(0,r.pipe)(m.snap,c.deactivate,q.makeLayers,(0,b.getCursor)(e),p.paint,b.setCursor,_,d.status)(G))];return{newGame:()=>G=(0,r.pipe)(u.shuffle,p.paint)(D()),getState:()=>(0,g.clone)(G),setState:e=>G=(0,r.pipe)(g.clone,p.paint)(e),update:()=>G=(0,r.pipe)(i.updCanvas,p.paint)(G),destroy:()=>{"CANVAS"!==z.tagName&&G.canvas.element.remove(),G=null,M.map(e=>e.remove())}}};exports.puzzle=z;var C=z;exports.default=C;
},{"./utils/dom.js":"hZBy","./utils/pipe.js":"ZnGg","./utils/tap.js":"BphK","./utils/event-listeners.js":"LmCC","./lib/canvas/make-canvas.js":"e2v7","./lib/canvas/load-image.js":"GEDr","./lib/core/make-puzzle.js":"nCpN","./lib/core/make-pieces.js":"AIfJ","./lib/core/shuffle.js":"QWdw","./lib/canvas/paint.js":"TT8H","./lib/core/activate.js":"OVt2","./lib/core/deactivate.js":"bOwK","./lib/core/move.js":"B4mP","./lib/core/snap.js":"ioHo","./lib/core/status.js":"fjpq","./lib/core/gather.js":"Po9z","./lib/core/clone.js":"Gh4z","./lib/canvas/make-layers.js":"o99t","./lib/canvas/cursor.js":"PXdr","./lib/core/move-foreground.js":"xfTU","./utils/safariDrawImageFix.js":"qbmb"}]},{},["Focm"], null)